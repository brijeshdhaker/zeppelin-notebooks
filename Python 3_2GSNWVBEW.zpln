{
  "paragraphs": [
    {
      "text": "%md\n\u003ca\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page1.svg\" width\u003d500 height\u003d250\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-05-23 03:34:10.720",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "tableHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page1.svg\" width\u003d500 height\u003d250\u003e\n\u003c/a\u003e\n\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994508_849835941",
      "id": "20220103-112314_1230550504",
      "dateCreated": "2022-01-03 11:23:14.508",
      "dateStarted": "2022-05-23 03:34:10.720",
      "dateFinished": "2022-05-23 03:34:12.965",
      "status": "FINISHED"
    },
    {
      "text": "%md\n* [RDD API](http://nbviewer.ipython.org/github/jkthompson/pyspark-pictures/blob/master/pyspark-pictures.ipynb)\n* [GitHub](https://github.com/jkthompson/pyspark-pictures)\n* [related blog post](http://data-frack.blogspot.com/2015/01/visual-mnemonics-for-pyspark-api.html)",
      "user": "anonymous",
      "dateUpdated": "2022-05-23 03:34:17.461",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": false,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        },
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "tableHide": true
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cul\u003e\n  \u003cli\u003e\u003ca href\u003d\"http://nbviewer.ipython.org/github/jkthompson/pyspark-pictures/blob/master/pyspark-pictures.ipynb\"\u003eRDD API\u003c/a\u003e\u003c/li\u003e\n  \u003cli\u003e\u003ca href\u003d\"https://github.com/jkthompson/pyspark-pictures\"\u003eGitHub\u003c/a\u003e\u003c/li\u003e\n  \u003cli\u003e\u003ca href\u003d\"http://data-frack.blogspot.com/2015/01/visual-mnemonics-for-pyspark-api.html\"\u003erelated blog post\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994508_2123309038",
      "id": "20220103-112314_1097892704",
      "dateCreated": "2022-01-03 11:23:14.508",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page2.svg\" width\u003d500 height\u003d500\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.508",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page2.svg\" width\u003d500 height\u003d500\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994508_430568162",
      "id": "20220103-112314_614177397",
      "dateCreated": "2022-01-03 11:23:14.508",
      "status": "READY"
    },
    {
      "text": "%md\n# Click on a picture to view pyspark docs",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.508",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ch1\u003eClick on a picture to view pyspark docs\u003c/h1\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994508_432776348",
      "id": "20220103-112314_1630889477",
      "dateCreated": "2022-01-03 11:23:14.508",
      "status": "READY"
    },
    {
      "text": "%python\n# versions\nimport IPython\nprint(\"pyspark version:\" + str(sc.version))\nprint(\"Ipython version:\" + str(IPython.__version__))",
      "user": "anonymous",
      "dateUpdated": "2022-11-23 17:08:04.924",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false,
        "colWidth": 12.0,
        "fontSize": 9.0,
        "enabled": true,
        "results": {},
        "editorSetting": {
          "language": "python",
          "editOnDblClick": false,
          "completionSupport": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "ERROR",
        "msg": [
          {
            "type": "TEXT",
            "data": "\u001b[0;31m---------------------------------------------------------------------------\u001b[0m\n\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)\n\u001b[0;32m/tmp/ipykernel_383/2676512168.py\u001b[0m in \u001b[0;36m\u003cmodule\u003e\u001b[0;34m\u001b[0m\n\u001b[1;32m      1\u001b[0m \u001b[0;31m# versions\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      2\u001b[0m \u001b[0;32mimport\u001b[0m \u001b[0mIPython\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----\u003e 3\u001b[0;31m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"pyspark version:\"\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0mstr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0msc\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mversion\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      4\u001b[0m \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"Ipython version:\"\u001b[0m \u001b[0;34m+\u001b[0m \u001b[0mstr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mIPython\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m__version__\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\n\u001b[0;31mNameError\u001b[0m: name \u0027sc\u0027 is not defined"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994508_362771995",
      "id": "20220103-112314_695298832",
      "dateCreated": "2022-01-03 11:23:14.508",
      "dateStarted": "2022-11-23 17:08:04.935",
      "dateFinished": "2022-11-23 17:08:09.872",
      "status": "ERROR"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.agg\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page3.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.508",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.agg\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page3.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994508_329456272",
      "id": "20220103-112314_168422439",
      "dateCreated": "2022-01-03 11:23:14.508",
      "status": "READY"
    },
    {
      "text": "%python\n# agg\nx \u003d sqlContext.createDataFrame([(\"Alice\",\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.agg({\"amt\":\"avg\"})\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-------------------+\n|           avg(amt)|\n+-------------------+\n|0.20000000000000004|\n+-------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_1519229579",
      "id": "20220103-112314_679624605",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.alias\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page4.svg\" width\u003d750 height\u003d750 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.alias\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page4.svg\" width\u003d750 height\u003d750 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_490632244",
      "id": "20220103-112314_644605722",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%python\n# alias\nfrom pyspark.sql.functions import col\nx \u003d sqlContext.createDataFrame([(\"Alice\",\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.alias(\u0027transactions\u0027)\nx.show()\ny.show()\ny.select(col(\"transactions.to\")).show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-----+\n|   to|\n+-----+\n|  Bob|\n|Carol|\n| Dave|\n+-----+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_924080743",
      "id": "20220103-112314_1403208108",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.cache\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page5.svg\" width\u003d750 height\u003d750 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.cache\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page5.svg\" width\u003d750 height\u003d750 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_554750110",
      "id": "20220103-112314_370075435",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%python\n# cache\nx \u003d sqlContext.createDataFrame([(\"Alice\",\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\nx.cache()\nprint(x.count()) # first action materializes x in memory\nprint(x.count()) # later actions avoid IO overhead",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "3\n3\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_735983480",
      "id": "20220103-112314_793332896",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.coalesce\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page6.svg\" width\u003d750 height\u003d750 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.coalesce\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page6.svg\" width\u003d750 height\u003d750 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_160184505",
      "id": "20220103-112314_1457728868",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%python\n# coalesce\nx_rdd \u003d sc.parallelize([(\"Alice\",\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)],2)\nx \u003d sqlContext.createDataFrame(x_rdd, [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.coalesce(numPartitions\u003d1)\nprint(x.rdd.getNumPartitions())\nprint(y.rdd.getNumPartitions())",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "2\n1\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_1457524300",
      "id": "20220103-112314_528791605",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.collect\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page7.svg\" width\u003d750 height\u003d750 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.collect\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page7.svg\" width\u003d750 height\u003d750 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_1784322364",
      "id": "20220103-112314_2127704913",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%python\n# collect\nx \u003d sqlContext.createDataFrame([(\"Alice\",\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.collect() # creates list of rows on driver\nx.show()\nprint(y)",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n[Row(from\u003du\u0027Alice\u0027, to\u003du\u0027Bob\u0027, amt\u003d0.1), Row(from\u003du\u0027Bob\u0027, to\u003du\u0027Carol\u0027, amt\u003d0.2), Row(from\u003du\u0027Carol\u0027, to\u003du\u0027Dave\u0027, amt\u003d0.3)]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_1025322603",
      "id": "20220103-112314_463166567",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.columns\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page8.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.columns\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page8.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_1828980175",
      "id": "20220103-112314_1423759997",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%python\n# columns\nx \u003d sqlContext.createDataFrame([(\"Alice\",\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.columns #creates list of column names on driver\nx.show()\nprint(y)",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n[\u0027from\u0027, \u0027to\u0027, \u0027amt\u0027]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_572888963",
      "id": "20220103-112314_1856214467",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.corr\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page9.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.corr\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page9.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_1717200935",
      "id": "20220103-112314_17071101",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%python\n# corr\nx \u003d sqlContext.createDataFrame([(\"Alice\",\"Bob\",0.1,0.001),(\"Bob\",\"Carol\",0.2,0.02),(\"Carol\",\"Dave\",0.3,0.02)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027,\u0027fee\u0027])\ny \u003d x.corr(col1\u003d\"amt\",col2\u003d\"fee\")\nx.show()\nprint(y)",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+-----+\n| from|   to|amt|  fee|\n+-----+-----+---+-----+\n|Alice|  Bob|0.1|0.001|\n|  Bob|Carol|0.2| 0.02|\n|Carol| Dave|0.3| 0.02|\n+-----+-----+---+-----+\n\n0.866025403784\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_1144277126",
      "id": "20220103-112314_1086154718",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.count\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page10.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.count\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page10.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_1880528499",
      "id": "20220103-112314_1921008262",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%python\n# count\nx \u003d sqlContext.createDataFrame([(\"Alice\",\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\nx.show()\nprint(x.count())",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n3\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_2133885756",
      "id": "20220103-112314_8379544",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.cov\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page11.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.cov\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page11.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_1203547924",
      "id": "20220103-112314_579245305",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%python\n# cov\nx \u003d sqlContext.createDataFrame([(\"Alice\",\"Bob\",0.1,0.001),(\"Bob\",\"Carol\",0.2,0.02),(\"Carol\",\"Dave\",0.3,0.02)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027,\u0027fee\u0027])\ny \u003d x.cov(col1\u003d\"amt\",col2\u003d\"fee\")\nx.show()\nprint(y)",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+-----+\n| from|   to|amt|  fee|\n+-----+-----+---+-----+\n|Alice|  Bob|0.1|0.001|\n|  Bob|Carol|0.2| 0.02|\n|Carol| Dave|0.3| 0.02|\n+-----+-----+---+-----+\n\n0.00095\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_51272168",
      "id": "20220103-112314_154043616",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.crosstab\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page12.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.crosstab\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page12.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_287214894",
      "id": "20220103-112314_2034918193",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%python\n# crosstab\nx \u003d sqlContext.createDataFrame([(\"Alice\",\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.crosstab(col1\u003d\u0027from\u0027,col2\u003d\u0027to\u0027)\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.509",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-------+----+-----+---+\n|from_to|Dave|Carol|Bob|\n+-------+----+-----+---+\n|    Bob|   0|    1|  0|\n|  Alice|   0|    0|  1|\n|  Carol|   1|    0|  0|\n+-------+----+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_1275925862",
      "id": "20220103-112314_120585116",
      "dateCreated": "2022-01-03 11:23:14.509",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.cube\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page13.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.cube\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page13.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994509_1895986582",
      "id": "20220103-112314_286820060",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%python\n# cube\nx \u003d sqlContext.createDataFrame([(\"Alice\",\"Bob\",0.1),(\"Alice\",\"Carol\",0.2)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.cube(\u0027from\u0027,\u0027to\u0027)\nx.show()\nprint(y) # y is a grouped data object, aggregations will be applied to all numerical columns\ny.sum().show() \ny.max().show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|Alice|Carol|0.2|\n+-----+-----+---+\n\n\u003cpyspark.sql.group.GroupedData object at 0x7fc5383bcc50\u003e\n+-----+-----+-------------------+\n| from|   to|           sum(amt)|\n+-----+-----+-------------------+\n|Alice|Carol|                0.2|\n|Alice|  Bob|                0.1|\n|Alice| null|0.30000000000000004|\n| null|Carol|                0.2|\n| null|  Bob|                0.1|\n| null| null|0.30000000000000004|\n+-----+-----+-------------------+\n\n+-----+-----+--------+\n| from|   to|max(amt)|\n+-----+-----+--------+\n|Alice|Carol|     0.2|\n|Alice|  Bob|     0.1|\n|Alice| null|     0.2|\n| null|Carol|     0.2|\n| null|  Bob|     0.1|\n| null| null|     0.2|\n+-----+-----+--------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_772420826",
      "id": "20220103-112314_1819019675",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.describe\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page14.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.describe\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page14.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_392113062",
      "id": "20220103-112314_1184218316",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%python\n# describe\nx \u003d sqlContext.createDataFrame([(\"Alice\",\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\nx.show()\nx.describe().show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-------+-------------------+\n|summary|                amt|\n+-------+-------------------+\n|  count|                  3|\n|   mean|0.20000000000000004|\n| stddev|0.09999999999999998|\n|    min|                0.1|\n|    max|                0.3|\n+-------+-------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_694751093",
      "id": "20220103-112314_1042173081",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.distinct\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page15.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.distinct\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page15.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_1116198395",
      "id": "20220103-112314_1810174944",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%python\n# distinct\nx \u003d sqlContext.createDataFrame([(\"Alice\",\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3),(\"Bob\",\"Carol\",0.2)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.distinct()\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n|  Bob|Carol|0.2|\n+-----+-----+---+\n\n+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n|Alice|  Bob|0.1|\n+-----+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_208303618",
      "id": "20220103-112314_1741287382",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.drop\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page16.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.drop\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page16.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_526009785",
      "id": "20220103-112314_215043135",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%python\n# drop\nx \u003d sqlContext.createDataFrame([(\"Alice\",\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.drop(\u0027amt\u0027)\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-----+-----+\n| from|   to|\n+-----+-----+\n|Alice|  Bob|\n|  Bob|Carol|\n|Carol| Dave|\n+-----+-----+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_1582880586",
      "id": "20220103-112314_1088926648",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.dropDuplicates\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page17.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.dropDuplicates\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page17.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_606166784",
      "id": "20220103-112314_64934487",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%python\n# dropDuplicates / drop_duplicates\nx \u003d sqlContext.createDataFrame([(\"Alice\",\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Bob\",\"Carol\",0.3),(\"Bob\",\"Carol\",0.2)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.dropDuplicates(subset\u003d[\u0027from\u0027,\u0027to\u0027])\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|  Bob|Carol|0.3|\n|  Bob|Carol|0.2|\n+-----+-----+---+\n\n+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|  Bob|Carol|0.2|\n|Alice|  Bob|0.1|\n+-----+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_622672922",
      "id": "20220103-112314_725695141",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.dropna\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page18.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.dropna\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page18.svg\" width\u003d500 height\u003d500 /\u003e\n\u003cp\u003e\u0026lt;\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_1482115979",
      "id": "20220103-112314_762788678",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%python\n# dropna\nx \u003d sqlContext.createDataFrame([(None,\"Bob\",0.1),(\"Bob\",\"Carol\",None),(\"Carol\",None,0.3),(\"Bob\",\"Carol\",0.2)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.dropna(how\u003d\u0027any\u0027,subset\u003d[\u0027from\u0027,\u0027to\u0027])\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+----+\n| from|   to| amt|\n+-----+-----+----+\n| null|  Bob| 0.1|\n|  Bob|Carol|null|\n|Carol| null| 0.3|\n|  Bob|Carol| 0.2|\n+-----+-----+----+\n\n+----+-----+----+\n|from|   to| amt|\n+----+-----+----+\n| Bob|Carol|null|\n| Bob|Carol| 0.2|\n+----+-----+----+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_2001854799",
      "id": "20220103-112314_125802782",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.dtypes\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page19.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.dtypes\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page19.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_1041953060",
      "id": "20220103-112314_331759548",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%python\n# dtypes\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.dtypes\nx.show()\nprint(y)",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n[(\u0027from\u0027, \u0027string\u0027), (\u0027to\u0027, \u0027string\u0027), (\u0027amt\u0027, \u0027double\u0027)]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_1380936381",
      "id": "20220103-112314_1121864664",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.explain\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page20.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.explain\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page20.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_901766637",
      "id": "20220103-112314_799197448",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%python\n# explain\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\nx.show()\nx.agg({\"amt\":\"avg\"}).explain(extended \u003d True)",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n\u003d\u003d Parsed Logical Plan \u003d\u003d\n\u0027Aggregate [\u0027avg(amt#296) AS avg(amt)#297]\n+- LogicalRDD [from#294,to#295,amt#296], MapPartitionsRDD[194] at applySchemaToPythonRDD at null:-1\n\n\u003d\u003d Analyzed Logical Plan \u003d\u003d\navg(amt): double\nAggregate [(avg(amt#296),mode\u003dComplete,isDistinct\u003dfalse) AS avg(amt)#297]\n+- LogicalRDD [from#294,to#295,amt#296], MapPartitionsRDD[194] at applySchemaToPythonRDD at null:-1\n\n\u003d\u003d Optimized Logical Plan \u003d\u003d\nAggregate [(avg(amt#296),mode\u003dComplete,isDistinct\u003dfalse) AS avg(amt)#297]\n+- Project [amt#296]\n   +- LogicalRDD [from#294,to#295,amt#296], MapPartitionsRDD[194] at applySchemaToPythonRDD at null:-1\n\n\u003d\u003d Physical Plan \u003d\u003d\nTungstenAggregate(key\u003d[], functions\u003d[(avg(amt#296),mode\u003dFinal,isDistinct\u003dfalse)], output\u003d[avg(amt)#297])\n+- TungstenExchange SinglePartition, None\n   +- TungstenAggregate(key\u003d[], functions\u003d[(avg(amt#296),mode\u003dPartial,isDistinct\u003dfalse)], output\u003d[sum#301,count#302L])\n      +- Project [amt#296]\n         +- Scan ExistingRDD[from#294,to#295,amt#296]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_2071121333",
      "id": "20220103-112314_1424888459",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.fillna\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page21.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.fillna\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page21.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_649398942",
      "id": "20220103-112314_1995959413",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%python\n# fillna\nx \u003d sqlContext.createDataFrame([(None,\"Bob\",0.1),(\"Bob\",\"Carol\",None),(\"Carol\",None,0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.fillna(value\u003d\u0027unknown\u0027,subset\u003d[\u0027from\u0027,\u0027to\u0027])\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+----+\n| from|   to| amt|\n+-----+-----+----+\n| null|  Bob| 0.1|\n|  Bob|Carol|null|\n|Carol| null| 0.3|\n+-----+-----+----+\n\n+-------+-------+----+\n|   from|     to| amt|\n+-------+-------+----+\n|unknown|    Bob| 0.1|\n|    Bob|  Carol|null|\n|  Carol|unknown| 0.3|\n+-------+-------+----+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_1493610074",
      "id": "20220103-112314_1187510776",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.filter\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page22.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.filter\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page22.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_67394180",
      "id": "20220103-112314_2132054689",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%python\n# filter\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.filter(\"amt \u003e 0.1\")\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_1065527395",
      "id": "20220103-112314_1540009346",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.first\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page23.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.first\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page23.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_382363714",
      "id": "20220103-112314_303523530",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%python\n# first\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.first()\nx.show()\nprint(y)",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\nRow(from\u003du\u0027Alice\u0027, to\u003du\u0027Bob\u0027, amt\u003d0.1)\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_669035771",
      "id": "20220103-112314_1801864521",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.flatMap\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page24.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.flatMap\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page24.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_1909767191",
      "id": "20220103-112314_809255710",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%python\n# flatMap\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.flatMap(lambda x: (x[0],x[2])) \nprint(y) # implicit coversion to RDD\ny.collect()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "PythonRDD[227] at RDD at PythonRDD.scala:43\n"
          },
          {
            "type": "TEXT",
            "data": "[u\u0027Alice\u0027, 0.1, u\u0027Bob\u0027, 0.2, u\u0027Carol\u0027, 0.3]"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_1074817988",
      "id": "20220103-112314_1041522214",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.foreach\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page25.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.foreach\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page25.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_1288977010",
      "id": "20220103-112314_1964992914",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%python\n# foreach\nfrom __future__ import print_function\n\n# setup\nfn \u003d \u0027./foreachExampleDataFrames.txt\u0027 \nopen(fn, \u0027w\u0027).close()  # clear the file\ndef fappend(el,f):\n    \u0027\u0027\u0027appends el to file f\u0027\u0027\u0027\n    print(el,file\u003dopen(f, \u0027a+\u0027) )\n\n# example\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.foreach(lambda x: fappend(x,fn)) # writes into foreachExampleDataFrames.txt\nx.show() # original dataframe\nprint(y) # foreach returns \u0027None\u0027\n# print the contents of the file\nwith open(fn, \"r\") as foreachExample:\n    print (foreachExample.read())",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\nNone\nRow(from\u003du\u0027Carol\u0027, to\u003du\u0027Dave\u0027, amt\u003d0.3)\nRow(from\u003du\u0027Bob\u0027, to\u003du\u0027Carol\u0027, amt\u003d0.2)\nRow(from\u003du\u0027Alice\u0027, to\u003du\u0027Bob\u0027, amt\u003d0.1)\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_154599603",
      "id": "20220103-112314_1945986683",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.foreachPartition\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page26.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.foreachPartition\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page26.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_28872963",
      "id": "20220103-112314_326898252",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%python\n# foreachPartition\nfrom __future__ import print_function\n\n#setup\nfn \u003d \u0027./foreachPartitionExampleDataFrames.txt\u0027\nopen(fn, \u0027w\u0027).close()  # clear the file\ndef fappend(partition,f):\n    \u0027\u0027\u0027append all elements in partition to file f\u0027\u0027\u0027\n    print([el for el in partition],file\u003dopen(f, \u0027a+\u0027))\n\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\nx \u003d x.repartition(2) # force 2 partitions\ny \u003d x.foreachPartition(lambda x: fappend(x,fn)) # writes into foreachPartitionExampleDataFrames.txt\n\nx.show() # original dataframe\nprint(y) # foreach returns \u0027None\u0027\n# print the contents of the file\nwith open(fn, \"r\") as foreachExample:\n    print (foreachExample.read())",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\nNone\n[]\n[Row(from\u003du\u0027Alice\u0027, to\u003du\u0027Bob\u0027, amt\u003d0.1), Row(from\u003du\u0027Bob\u0027, to\u003du\u0027Carol\u0027, amt\u003d0.2), Row(from\u003du\u0027Carol\u0027, to\u003du\u0027Dave\u0027, amt\u003d0.3)]\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_730149409",
      "id": "20220103-112314_588444940",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.freqItems\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page27.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.freqItems\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page27.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_1981841712",
      "id": "20220103-112314_760175365",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%python\n# freqItems\nx \u003d sqlContext.createDataFrame([(\"Bob\",\"Carol\",0.1), \\\n                                (\"Alice\",\"Dave\",0.1), \\\n                                (\"Alice\",\"Bob\",0.1), \\\n                                (\"Alice\",\"Bob\",0.5), \\\n                                (\"Carol\",\"Bob\",0.1)], \\\n                               [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.freqItems(cols\u003d[\u0027from\u0027,\u0027amt\u0027],support\u003d0.8)\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|  Bob|Carol|0.1|\n|Alice| Dave|0.1|\n|Alice|  Bob|0.1|\n|Alice|  Bob|0.5|\n|Carol|  Bob|0.1|\n+-----+-----+---+\n\n+--------------+-------------+\n|from_freqItems|amt_freqItems|\n+--------------+-------------+\n|       [Alice]|        [0.1]|\n+--------------+-------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_1565349258",
      "id": "20220103-112314_899231337",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.groupBy\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page28.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.groupBy\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page28.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_747417398",
      "id": "20220103-112314_1174713572",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%python\n# groupBy\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Alice\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.groupBy(\u0027from\u0027)\nx.show()\nprint(y)",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|Alice|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n\u003cpyspark.sql.group.GroupedData object at 0x7fc53831f5d0\u003e\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_2013125451",
      "id": "20220103-112314_1913295805",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.groupBy\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page29.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.510",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.groupBy\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page29.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_2010794237",
      "id": "20220103-112314_634022282",
      "dateCreated": "2022-01-03 11:23:14.510",
      "status": "READY"
    },
    {
      "text": "%python\n# groupBy(col1).avg(col2)\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Alice\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.groupBy(\u0027from\u0027).avg(\u0027amt\u0027)\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|Alice|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-----+-------------------+\n| from|           avg(amt)|\n+-----+-------------------+\n|Carol|                0.3|\n|Alice|0.15000000000000002|\n+-----+-------------------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994510_1285828469",
      "id": "20220103-112314_1507651900",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.head\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page30.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.head\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page30.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_1485477974",
      "id": "20220103-112314_974966135",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%python\n# head\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.head(2)\nx.show()\nprint(y)",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n[Row(from\u003du\u0027Alice\u0027, to\u003du\u0027Bob\u0027, amt\u003d0.1), Row(from\u003du\u0027Bob\u0027, to\u003du\u0027Carol\u0027, amt\u003d0.2)]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_1283805415",
      "id": "20220103-112314_472721138",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.intersect\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page31.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.intersect\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page31.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_1242795911",
      "id": "20220103-112314_1784515268",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%python\n# intersect\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Alice\",0.2),(\"Carol\",\"Dave\",0.1)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\nz \u003d x.intersect(y)\nx.show()\ny.show()\nz.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Alice|0.2|\n|Carol| Dave|0.1|\n+-----+-----+---+\n\n+-----+---+---+\n| from| to|amt|\n+-----+---+---+\n|Alice|Bob|0.1|\n+-----+---+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_1256907682",
      "id": "20220103-112314_1421263778",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.isLocal\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page32.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.isLocal\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page32.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_614929901",
      "id": "20220103-112314_136174390",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%python\n# isLocal\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.isLocal()\nx.show()\nprint(y)",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\nFalse\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_1658871007",
      "id": "20220103-112314_2113042033",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.join\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page33.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.join\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page33.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_1908864513",
      "id": "20220103-112314_2071972001",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%python\n# join\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,20),(\"Bob\",40),(\"Dave\",80)], [\u0027name\u0027,\u0027age\u0027])\nz \u003d x.join(y,x.to \u003d\u003d y.name,\u0027inner\u0027).select(\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027,\u0027age\u0027)\nx.show()\ny.show()\nz.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-----+---+\n| name|age|\n+-----+---+\n|Alice| 20|\n|  Bob| 40|\n| Dave| 80|\n+-----+---+\n\n+-----+----+---+---+\n| from|  to|amt|age|\n+-----+----+---+---+\n|Carol|Dave|0.3| 80|\n|Alice| Bob|0.1| 40|\n+-----+----+---+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_1938837622",
      "id": "20220103-112314_431407039",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.limit\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page34.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.limit\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page34.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_2088801454",
      "id": "20220103-112314_2140410836",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%python\n# limit\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.limit(2)\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n+-----+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_22114157",
      "id": "20220103-112314_297513897",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.map\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page35.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.map\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page35.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_1432045928",
      "id": "20220103-112314_335830015",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%python\n# map\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.map(lambda x: x.amt+1)\nx.show()\nprint(y.collect())  # output is RDD",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n[1.1, 1.2, 1.3]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_216405473",
      "id": "20220103-112314_954422663",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.mapPartitions\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page36.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.mapPartitions\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page36.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_85375385",
      "id": "20220103-112314_1740045308",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%python\n# mapPartitions\ndef amt_sum(partition):\n    \u0027\u0027\u0027sum the value in field amt\u0027\u0027\u0027\n    yield sum([el.amt for el in partition])\n    \nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\nx \u003d x.repartition(2) # force 2 partitions\ny \u003d x.mapPartitions(lambda p: amt_sum(p))\nx.show()\nprint(x.rdd.glom().collect()) # flatten elements on the same partition\nprint(y.collect())\nprint(y.glom().collect())",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n[[Row(from\u003du\u0027Alice\u0027, to\u003du\u0027Bob\u0027, amt\u003d0.1), Row(from\u003du\u0027Bob\u0027, to\u003du\u0027Carol\u0027, amt\u003d0.2), Row(from\u003du\u0027Carol\u0027, to\u003du\u0027Dave\u0027, amt\u003d0.3)], []]\n[0.6000000000000001, 0]\n[[0.6000000000000001], [0]]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_1556151738",
      "id": "20220103-112314_735853144",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.na\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page37.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.na\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page37.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_1156801177",
      "id": "20220103-112314_489772927",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%python\n# na\nx \u003d sqlContext.createDataFrame([(None,\"Bob\",0.1),(\"Bob\",\"Carol\",None),(\"Carol\",None,0.3),(\"Bob\",\"Carol\",0.2)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.na  # returns an object for handling missing values, supports drop, fill, and replace methods\nx.show()\nprint(y)\ny.drop().show()\ny.fill({\u0027from\u0027:\u0027unknown\u0027,\u0027to\u0027:\u0027unknown\u0027,\u0027amt\u0027:0}).show()\ny.fill(0).show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+----+\n| from|   to| amt|\n+-----+-----+----+\n| null|  Bob| 0.1|\n|  Bob|Carol|null|\n|Carol| null| 0.3|\n|  Bob|Carol| 0.2|\n+-----+-----+----+\n\n\u003cpyspark.sql.dataframe.DataFrameNaFunctions object at 0x7fc538392b90\u003e\n+----+-----+---+\n|from|   to|amt|\n+----+-----+---+\n| Bob|Carol|0.2|\n+----+-----+---+\n\n+-------+-------+---+\n|   from|     to|amt|\n+-------+-------+---+\n|unknown|    Bob|0.1|\n|    Bob|  Carol|0.0|\n|  Carol|unknown|0.3|\n|    Bob|  Carol|0.2|\n+-------+-------+---+\n\n+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n| null|  Bob|0.1|\n|  Bob|Carol|0.0|\n|Carol| null|0.3|\n|  Bob|Carol|0.2|\n+-----+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_1559927123",
      "id": "20220103-112314_1071408691",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.orderBy\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page38.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.orderBy\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page38.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_1077944936",
      "id": "20220103-112314_1877283631",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%python\n# orderBy\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.orderBy([\u0027from\u0027],ascending\u003d[False])\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Carol| Dave|0.3|\n|  Bob|Carol|0.2|\n|Alice|  Bob|0.1|\n+-----+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_32056243",
      "id": "20220103-112314_631368305",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.persist\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page39.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.persist\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page39.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_1567844589",
      "id": "20220103-112314_842844949",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%python\n# persist\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\nx.persist(storageLevel\u003dStorageLevel(True,True,False,True,1)) # StorageLevel(useDisk,useMemory,useOffHeap,deserialized,replication\u003d1)\nx.show()\nx.is_cached",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n"
          },
          {
            "type": "TEXT",
            "data": "True"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_1350425664",
      "id": "20220103-112314_1846402719",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.printSchema\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page40.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.printSchema\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page40.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_1196626648",
      "id": "20220103-112314_691459098",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%python\n# printSchema\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\nx.show()\nx.printSchema()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\nroot\n |-- from: string (nullable \u003d true)\n |-- to: string (nullable \u003d true)\n |-- amt: double (nullable \u003d true)\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_1425412639",
      "id": "20220103-112314_65949999",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.randomSplit\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page41.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.randomSplit\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page41.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_7016272",
      "id": "20220103-112314_1465796132",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%python\n# randomSplit\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.randomSplit([0.5,0.5])\nx.show()\ny[0].show()\ny[1].show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+----+---+---+\n|from| to|amt|\n+----+---+---+\n+----+---+---+\n\n+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_861025902",
      "id": "20220103-112314_1462211446",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.rdd\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page42.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.rdd\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page42.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_293460075",
      "id": "20220103-112314_1219369868",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%python\n# rdd\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.rdd\nx.show()\nprint(y.collect())",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.511",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n[Row(from\u003du\u0027Alice\u0027, to\u003du\u0027Bob\u0027, amt\u003d0.1), Row(from\u003du\u0027Bob\u0027, to\u003du\u0027Carol\u0027, amt\u003d0.2), Row(from\u003du\u0027Carol\u0027, to\u003du\u0027Dave\u0027, amt\u003d0.3)]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994511_666170354",
      "id": "20220103-112314_959990943",
      "dateCreated": "2022-01-03 11:23:14.511",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.registerTempTable\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page43.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.512",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.registerTempTable\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page43.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994512_1367338498",
      "id": "20220103-112314_485638906",
      "dateCreated": "2022-01-03 11:23:14.512",
      "status": "READY"
    },
    {
      "text": "%python\n# registerTempTable\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\nx.registerTempTable(name\u003d\"TRANSACTIONS\")\ny \u003d sqlContext.sql(\u0027SELECT * FROM TRANSACTIONS WHERE amt \u003e 0.1\u0027)\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.512",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994512_1801008688",
      "id": "20220103-112314_2007354929",
      "dateCreated": "2022-01-03 11:23:14.512",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.repartition\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page44.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.512",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.repartition\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page44.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994512_1802951312",
      "id": "20220103-112314_1332726066",
      "dateCreated": "2022-01-03 11:23:14.512",
      "status": "READY"
    },
    {
      "text": "%python\n# repartition\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.repartition(3)\nprint(x.rdd.getNumPartitions())\nprint(y.rdd.getNumPartitions())",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.512",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "4\n3\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994512_614919139",
      "id": "20220103-112314_885537012",
      "dateCreated": "2022-01-03 11:23:14.512",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.replace\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page45.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.512",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.replace\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page45.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994512_421982217",
      "id": "20220103-112314_975390981",
      "dateCreated": "2022-01-03 11:23:14.512",
      "status": "READY"
    },
    {
      "text": "%python\n# replace\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.replace(\u0027Dave\u0027,\u0027David\u0027,[\u0027from\u0027,\u0027to\u0027])\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.512",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol|David|0.3|\n+-----+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994512_1234030557",
      "id": "20220103-112314_1672404022",
      "dateCreated": "2022-01-03 11:23:14.512",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.rollup\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page46.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.512",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.rollup\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page46.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994512_1382647396",
      "id": "20220103-112314_1379512104",
      "dateCreated": "2022-01-03 11:23:14.512",
      "status": "READY"
    },
    {
      "text": "%python\n# rollup\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.rollup([\u0027from\u0027,\u0027to\u0027])\nx.show()\nprint(y) # y is a grouped data object, aggregations will be applied to all numerical columns\ny.sum().show()\ny.max().show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.512",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n\u003cpyspark.sql.group.GroupedData object at 0x7fc5382f7850\u003e\n+-----+-----+------------------+\n| from|   to|          sum(amt)|\n+-----+-----+------------------+\n|Alice|  Bob|               0.1|\n|  Bob|Carol|               0.2|\n|Alice| null|               0.1|\n|Carol| Dave|               0.3|\n|  Bob| null|               0.2|\n|Carol| null|               0.3|\n| null| null|0.6000000000000001|\n+-----+-----+------------------+\n\n+-----+-----+--------+\n| from|   to|max(amt)|\n+-----+-----+--------+\n|Alice|  Bob|     0.1|\n|  Bob|Carol|     0.2|\n|Alice| null|     0.1|\n|Carol| Dave|     0.3|\n|  Bob| null|     0.2|\n|Carol| null|     0.3|\n| null| null|     0.3|\n+-----+-----+--------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994512_901702934",
      "id": "20220103-112314_658711043",
      "dateCreated": "2022-01-03 11:23:14.512",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.sample\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page47.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.512",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.sample\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page47.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994512_517377303",
      "id": "20220103-112314_117980303",
      "dateCreated": "2022-01-03 11:23:14.512",
      "status": "READY"
    },
    {
      "text": "%python\n# sample\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.sample(False,0.5)\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.512",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+----+-----+---+\n|from|   to|amt|\n+----+-----+---+\n| Bob|Carol|0.2|\n+----+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994512_1969871452",
      "id": "20220103-112314_307367732",
      "dateCreated": "2022-01-03 11:23:14.512",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.sampleBy\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page48.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.512",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.sampleBy\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page48.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994512_484258234",
      "id": "20220103-112314_219001529",
      "dateCreated": "2022-01-03 11:23:14.512",
      "status": "READY"
    },
    {
      "text": "%python\n# sampleBy\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Alice\",\"Carol\",0.2),(\"Alice\",\"Alice\",0.3), \\\n                               (\u0027Alice\u0027,\"Dave\",0.4),(\"Bob\",\"Bob\",0.5),(\"Bob\",\"Carol\",0.6)], \\\n                                [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.sampleBy(col\u003d\u0027from\u0027,fractions\u003d{\u0027Alice\u0027:0.1,\u0027Bob\u0027:0.9})\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|Alice|Carol|0.2|\n|Alice|Alice|0.3|\n|Alice| Dave|0.4|\n|  Bob|  Bob|0.5|\n|  Bob|Carol|0.6|\n+-----+-----+---+\n\n+----+-----+---+\n|from|   to|amt|\n+----+-----+---+\n| Bob|  Bob|0.5|\n| Bob|Carol|0.6|\n+----+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994512_2060960142",
      "id": "20220103-112314_870369825",
      "dateCreated": "2022-01-03 11:23:14.512",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.schema\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page49.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003cp\u003e\u0026lt;a href\u003d\u0026quot;\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.schema\"\u003ehttp://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.schema\u003c/a\u003e\u003cbr/\u003e\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page49.svg\" width\u003d500 height\u003d500 /\u003e\u003cbr/\u003e\u003c/a\u003e\u003c/p\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_762622497",
      "id": "20220103-112314_1976198294",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%python\n# schema\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.schema\nx.show()\nprint(y)",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\nStructType(List(StructField(from,StringType,true),StructField(to,StringType,true),StructField(amt,DoubleType,true)))\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_956899165",
      "id": "20220103-112314_513889361",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.select\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page50.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.select\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page50.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_746424848",
      "id": "20220103-112314_1516863557",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%python\n# select\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.select([\u0027from\u0027,\u0027amt\u0027])\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-----+---+\n| from|amt|\n+-----+---+\n|Alice|0.1|\n|  Bob|0.2|\n|Carol|0.3|\n+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_639315173",
      "id": "20220103-112314_1053078628",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.selectExpr\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page51.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.selectExpr\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page51.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_2127946025",
      "id": "20220103-112314_1975392409",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%python\n# selectExpr\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.selectExpr([\u0027substr(from,1,1)\u0027,\u0027amt+10\u0027])\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+----------------+----------+\n|substr(from,1,1)|(amt + 10)|\n+----------------+----------+\n|               A|      10.1|\n|               B|      10.2|\n|               C|      10.3|\n+----------------+----------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_1024555337",
      "id": "20220103-112314_1630128547",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.show\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page52.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.show\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page52.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_117955295",
      "id": "20220103-112314_2001999467",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%python\n# show\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\nx.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_532082856",
      "id": "20220103-112314_1814625137",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.sort\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page53.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.sort\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page53.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_1177398651",
      "id": "20220103-112314_1775717565",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%python\n# sort\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Alice\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.sort([\u0027to\u0027])\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol|Alice|0.3|\n+-----+-----+---+\n\n+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Carol|Alice|0.3|\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n+-----+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_413242194",
      "id": "20220103-112314_1176302837",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.sortWithinPartitions\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page54.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.sortWithinPartitions\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page54.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_1019638529",
      "id": "20220103-112314_296502547",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%python\n# sortWithinPartitions\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1,1),(\"Bob\",\"Carol\",0.2,2),(\"Carol\",\"Alice\",0.3,2)], \\\n                               [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027,\u0027p_id\u0027]).repartition(2,\u0027p_id\u0027)\ny \u003d x.sortWithinPartitions([\u0027to\u0027])\nx.show()\ny.show()\nprint(x.rdd.glom().collect()) # glom() flattens elements on the same partition\nprint(y.rdd.glom().collect())",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+----+\n| from|   to|amt|p_id|\n+-----+-----+---+----+\n|Alice|  Bob|0.1|   1|\n|  Bob|Carol|0.2|   2|\n|Carol|Alice|0.3|   2|\n+-----+-----+---+----+\n\n+-----+-----+---+----+\n| from|   to|amt|p_id|\n+-----+-----+---+----+\n|Alice|  Bob|0.1|   1|\n|Carol|Alice|0.3|   2|\n|  Bob|Carol|0.2|   2|\n+-----+-----+---+----+\n\n[[Row(from\u003du\u0027Alice\u0027, to\u003du\u0027Bob\u0027, amt\u003d0.1, p_id\u003d1)], [Row(from\u003du\u0027Bob\u0027, to\u003du\u0027Carol\u0027, amt\u003d0.2, p_id\u003d2), Row(from\u003du\u0027Carol\u0027, to\u003du\u0027Alice\u0027, amt\u003d0.3, p_id\u003d2)]]\n[[Row(from\u003du\u0027Alice\u0027, to\u003du\u0027Bob\u0027, amt\u003d0.1, p_id\u003d1)], [Row(from\u003du\u0027Carol\u0027, to\u003du\u0027Alice\u0027, amt\u003d0.3, p_id\u003d2), Row(from\u003du\u0027Bob\u0027, to\u003du\u0027Carol\u0027, amt\u003d0.2, p_id\u003d2)]]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_1753529728",
      "id": "20220103-112314_989124388",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.stat\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page55.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.stat\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page55.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_505523231",
      "id": "20220103-112314_1771423331",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%python\n# stat\nx \u003d sqlContext.createDataFrame([(\"Alice\",\"Bob\",0.1,0.001),(\"Bob\",\"Carol\",0.2,0.02),(\"Carol\",\"Dave\",0.3,0.02)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027,\u0027fee\u0027])\ny \u003d x.stat\nx.show()\nprint(y)\nprint(y.corr(col1\u003d\"amt\",col2\u003d\"fee\"))",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+-----+\n| from|   to|amt|  fee|\n+-----+-----+---+-----+\n|Alice|  Bob|0.1|0.001|\n|  Bob|Carol|0.2| 0.02|\n|Carol| Dave|0.3| 0.02|\n+-----+-----+---+-----+\n\n\u003cpyspark.sql.dataframe.DataFrameStatFunctions object at 0x7fc5382f7a50\u003e\n0.866025403784\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_1899473388",
      "id": "20220103-112314_1208958200",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.subtract\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page56.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.subtract\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page56.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_616680023",
      "id": "20220103-112314_997751863",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%python\n# subtract\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.1)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\nz \u003d x.subtract(y)\nx.show()\ny.show()\nz.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.1|\n+-----+-----+---+\n\n+-----+----+---+\n| from|  to|amt|\n+-----+----+---+\n|Carol|Dave|0.3|\n+-----+----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_896437418",
      "id": "20220103-112314_665436555",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.take\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page57.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.take\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page57.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_681136149",
      "id": "20220103-112314_1615375811",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%python\n# take\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.take(num\u003d2)\nx.show()\nprint(y)",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n[Row(from\u003du\u0027Alice\u0027, to\u003du\u0027Bob\u0027, amt\u003d0.1), Row(from\u003du\u0027Bob\u0027, to\u003du\u0027Carol\u0027, amt\u003d0.2)]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_1798959138",
      "id": "20220103-112314_1360111054",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.toDF\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page58.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.toDF\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page58.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_2098886988",
      "id": "20220103-112314_695267871",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%python\n# toDF\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.toDF(\"seller\",\"buyer\",\"amt\")\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+------+-----+---+\n|seller|buyer|amt|\n+------+-----+---+\n| Alice|  Bob|0.1|\n|   Bob|Carol|0.2|\n| Carol| Dave|0.3|\n+------+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_123705255",
      "id": "20220103-112314_1077730083",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.toJSON\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page59.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.toJSON\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page59.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_1584424347",
      "id": "20220103-112314_1707032658",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%python\n# toJSON\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Alice\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.toJSON()\nx.show()\nprint(y.collect())",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol|Alice|0.3|\n+-----+-----+---+\n\n[u\u0027{\"from\":\"Alice\",\"to\":\"Bob\",\"amt\":0.1}\u0027, u\u0027{\"from\":\"Bob\",\"to\":\"Carol\",\"amt\":0.2}\u0027, u\u0027{\"from\":\"Carol\",\"to\":\"Alice\",\"amt\":0.3}\u0027]\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_1004483883",
      "id": "20220103-112314_962377470",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.toPandas\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page60.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.513",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.toPandas\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page60.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_480834193",
      "id": "20220103-112314_395467712",
      "dateCreated": "2022-01-03 11:23:14.513",
      "status": "READY"
    },
    {
      "text": "%python\n# toPandas\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.toPandas()\nx.show()\nprint(type(y))\ny",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.514",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n\u003cclass \u0027pandas.core.frame.DataFrame\u0027\u003e\n"
          },
          {
            "type": "HTML",
            "data": "\u003cdiv\u003e\n\u003ctable border\u003d\"1\" class\u003d\"dataframe\"\u003e\n  \u003cthead\u003e\n    \u003ctr style\u003d\"text-align: right;\"\u003e\n      \u003cth\u003e\u003c/th\u003e\n      \u003cth\u003efrom\u003c/th\u003e\n      \u003cth\u003eto\u003c/th\u003e\n      \u003cth\u003eamt\u003c/th\u003e\n    \u003c/tr\u003e\n  \u003c/thead\u003e\n  \u003ctbody\u003e\n    \u003ctr\u003e\n      \u003cth\u003e0\u003c/th\u003e\n      \u003ctd\u003eAlice\u003c/td\u003e\n      \u003ctd\u003eBob\u003c/td\u003e\n      \u003ctd\u003e0.1\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e1\u003c/th\u003e\n      \u003ctd\u003eBob\u003c/td\u003e\n      \u003ctd\u003eCarol\u003c/td\u003e\n      \u003ctd\u003e0.2\u003c/td\u003e\n    \u003c/tr\u003e\n    \u003ctr\u003e\n      \u003cth\u003e2\u003c/th\u003e\n      \u003ctd\u003eCarol\u003c/td\u003e\n      \u003ctd\u003eDave\u003c/td\u003e\n      \u003ctd\u003e0.3\u003c/td\u003e\n    \u003c/tr\u003e\n  \u003c/tbody\u003e\n\u003c/table\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994513_1089081687",
      "id": "20220103-112314_835813330",
      "dateCreated": "2022-01-03 11:23:14.514",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.unionAll\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page61.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.514",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.unionAll\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page61.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994514_782774388",
      "id": "20220103-112314_779289706",
      "dateCreated": "2022-01-03 11:23:14.514",
      "status": "READY"
    },
    {
      "text": "%python\n# unionAll\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d sqlContext.createDataFrame([(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.1)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\nz \u003d x.unionAll(y)\nx.show()\ny.show()\nz.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.514",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n+-----+-----+---+\n\n+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|  Bob|Carol|0.2|\n|Carol| Dave|0.1|\n+-----+-----+---+\n\n+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.1|\n+-----+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994514_1054617871",
      "id": "20220103-112314_1917107228",
      "dateCreated": "2022-01-03 11:23:14.514",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.unpersist\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page62.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.514",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.unpersist\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page62.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994514_985864251",
      "id": "20220103-112314_2005771727",
      "dateCreated": "2022-01-03 11:23:14.514",
      "status": "READY"
    },
    {
      "text": "%python\n# unpersist\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\nx.cache()\nx.count()\nx.show()\nprint(x.is_cached)\nx.unpersist()\nprint(x.is_cached)",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.514",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\nTrue\nFalse\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994514_1276210450",
      "id": "20220103-112314_1301838595",
      "dateCreated": "2022-01-03 11:23:14.514",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.where\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page63.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.514",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.where\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page63.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994514_1511721390",
      "id": "20220103-112314_2080269966",
      "dateCreated": "2022-01-03 11:23:14.514",
      "status": "READY"
    },
    {
      "text": "%python\n# where (filter)\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.where(\"amt \u003e 0.1\")\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.514",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994514_1266426904",
      "id": "20220103-112314_739082673",
      "dateCreated": "2022-01-03 11:23:14.514",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.withColumn\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page64.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.514",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.withColumn\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page64.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994514_819904940",
      "id": "20220103-112314_909437474",
      "dateCreated": "2022-01-03 11:23:14.514",
      "status": "READY"
    },
    {
      "text": "%python\n# withColumn\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",None),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.withColumn(\u0027conf\u0027,x.amt.isNotNull())\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.514",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+----+\n| from|   to| amt|\n+-----+-----+----+\n|Alice|  Bob| 0.1|\n|  Bob|Carol|null|\n|Carol| Dave| 0.3|\n+-----+-----+----+\n\n+-----+-----+----+-----+\n| from|   to| amt| conf|\n+-----+-----+----+-----+\n|Alice|  Bob| 0.1| true|\n|  Bob|Carol|null|false|\n|Carol| Dave| 0.3| true|\n+-----+-----+----+-----+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994514_1023778370",
      "id": "20220103-112314_947572612",
      "dateCreated": "2022-01-03 11:23:14.514",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.withColumnRenamed\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page65.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.514",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.withColumnRenamed\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page65.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994514_699834121",
      "id": "20220103-112314_817370131",
      "dateCreated": "2022-01-03 11:23:14.514",
      "status": "READY"
    },
    {
      "text": "%python\n# withColumnRenamed\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.withColumnRenamed(\u0027amt\u0027,\u0027amount\u0027)\nx.show()\ny.show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.514",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+-----+-----+------+\n| from|   to|amount|\n+-----+-----+------+\n|Alice|  Bob|   0.1|\n|  Bob|Carol|   0.2|\n|Carol| Dave|   0.3|\n+-----+-----+------+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994514_1965709501",
      "id": "20220103-112314_1886919612",
      "dateCreated": "2022-01-03 11:23:14.514",
      "status": "READY"
    },
    {
      "text": "%md\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.write\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page66.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.514",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/markdown",
        "editorHide": true,
        "editorSetting": {
          "language": "markdown",
          "editOnDblClick": true
        }
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "HTML",
            "data": "\u003cdiv class\u003d\"markdown-body\"\u003e\n\u003ca href\u003d\"http://spark.apache.org/docs/latest/api/python/pyspark.sql.html#pyspark.sql.DataFrame.write\"\u003e\n\u003cimg align\u003dleft src\u003d\"files/images/pyspark-pictures-dataframes-page66.svg\" width\u003d500 height\u003d500 /\u003e\n\u003c/a\u003e\n\u003c/div\u003e"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994514_1342386976",
      "id": "20220103-112314_1636604523",
      "dateCreated": "2022-01-03 11:23:14.514",
      "status": "READY"
    },
    {
      "text": "%python\n# write\nimport json\nx \u003d sqlContext.createDataFrame([(\u0027Alice\u0027,\"Bob\",0.1),(\"Bob\",\"Carol\",0.2),(\"Carol\",\"Dave\",0.3)], [\u0027from\u0027,\u0027to\u0027,\u0027amt\u0027])\ny \u003d x.write.mode(\u0027overwrite\u0027).json(\u0027./dataframeWriteExample.json\u0027)\nx.show()\n# read the dataframe back in from file\nsqlContext.read.json(\u0027./dataframeWriteExample.json\u0027).show()",
      "user": "anonymous",
      "dateUpdated": "2022-01-03 11:23:14.514",
      "progress": 0,
      "config": {
        "editorMode": "ace/mode/python",
        "editorHide": false
      },
      "settings": {
        "params": {},
        "forms": {}
      },
      "results": {
        "code": "SUCCESS",
        "msg": [
          {
            "type": "TEXT",
            "data": "+-----+-----+---+\n| from|   to|amt|\n+-----+-----+---+\n|Alice|  Bob|0.1|\n|  Bob|Carol|0.2|\n|Carol| Dave|0.3|\n+-----+-----+---+\n\n+---+-----+-----+\n|amt| from|   to|\n+---+-----+-----+\n|0.1|Alice|  Bob|\n|0.2|  Bob|Carol|\n|0.3|Carol| Dave|\n+---+-----+-----+\n\n"
          }
        ]
      },
      "apps": [],
      "runtimeInfos": {},
      "progressUpdateIntervalMs": 500,
      "jobName": "paragraph_1641208994514_1926918873",
      "id": "20220103-112314_258244401",
      "dateCreated": "2022-01-03 11:23:14.514",
      "status": "READY"
    }
  ],
  "name": "Python 3",
  "id": "2GSNWVBEW",
  "defaultInterpreterGroup": "spark",
  "version": "0.10.0",
  "noteParams": {},
  "noteForms": {},
  "angularObjects": {},
  "config": {
    "isZeppelinNotebookCronEnable": false
  },
  "info": {}
}